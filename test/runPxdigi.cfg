process ProcessPixelDigitizer = {

  untracked PSet maxEvents = {untracked int32 input = -1}

	source = PoolSource { 
        untracked vstring fileNames = {'file:simHit.root'}
          untracked uint32 debugVebosity = 100
          untracked bool   debugFlag     = true
	}

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Fill CMS Geometry
  # include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

 
  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  # PixelDigitizer
  include "SimTracker/SiPixelDigitizer/data/PixelDigi.cfi"
  # replace siPixelDigis.MissCalibrate = false

  ### Mixing Module
  include "SimGeneral/MixingModule/data/mixNoPU.cfi"

    service = RandomNumberGeneratorService {
	untracked uint32 sourceSeed = 135799753
	PSet moduleSeeds =
	{
	    untracked uint32 VtxSmeared = 123456789
	    untracked uint32 g4SimHits = 194098651
	    untracked uint32 mix = 9823
	    untracked uint32 siPixelDigis = 923
	}
    }

  service = MessageLogger {  
	untracked vstring destinations   = { "debugmessages.txt" }
        untracked PSet debugmessages.txt = { untracked string threshold = "INFO"}
        untracked vstring debugModules={"pixdigi"}
  }


# analysis module if one wants to check the digis
#        module analysis =  PixelDigisTest {
#           untracked bool Verbosity = false
#           InputTag src = siPixelDigis
#        }
 


  module out = PoolOutputModule {
        untracked string fileName = 'pixdigi.root'
  }

  # when new simhits are digitized
  path p = {mix,siPixelDigis}
  # when I redigitze simhits from a root file which has digis already 
  # path p = {siPixelDigis, analysis}
  endpath outpath = { out }
}
